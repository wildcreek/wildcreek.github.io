<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Intel WebRTC Collaboration Suite 服务端部署及客户端配置说明 | wildcreek</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Intel WebRTC Collaboration Suite 服务端部署及客户端配置说明</h1><a id="logo" href="/.">wildcreek</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Intel WebRTC Collaboration Suite 服务端部署及客户端配置说明</h1><div class="post-meta">Nov 21, 2017</div><div class="post-content"><p>部署环境： Centos 6.4<br>部署版本：CS_WebRTC_Conference_Server_Peer.v3.5.tgz<br>客户端版本：CS_WebRTC_Client_SDK_Android.v3.5.zip</p>
<p>Intel WebRTC SDK 包含平台侧 MCU、P2P、Gateway和 客户端SDK（支持Android、iOS、JavaScriptWindows）,详细的介绍可以参考 <a href="https://software.intel.com/en-us/webrtc-sdk" target="_blank" rel="external">官网</a>。<br>为调研Intel开放的WebRTC方案的效果，按照文档部署了peer server 和 mcu server，这里使用的是3.5版本，该版本已经剔除了gateway sdk ，需要调研sip网关的可能需要参考之前的版本（如2.8.1和3.0版本）。客户端部署的是Android Sample，支持视屏通话，屏幕分享，文字聊天等功能，具备硬编解、Qos，预留了流处理和图像滤镜接口。</p>
<hr>
<h4 id="部署配置STUN-Server"><a href="#部署配置STUN-Server" class="headerlink" title="部署配置STUN Server"></a>部署配置STUN Server</h4><ol>
<li>使用开放stun 服务器：<a href="http://www.cnblogs.com/idignew/p/7341479.html" target="_blank" rel="external">http://www.cnblogs.com/idignew/p/7341479.html</a></li>
<li>开源部署coturn ：<a href="https://github.com/coturn/coturn" target="_blank" rel="external">https://github.com/coturn/coturn</a></li>
</ol>
<hr>
<h4 id="编译安装Peer-Server"><a href="#编译安装Peer-Server" class="headerlink" title="编译安装Peer Server"></a>编译安装Peer Server</h4><ol>
<li>安装nodejs npm ，安装n模块，切换node至合适版本</li>
<li><p>解压安装peer server</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">tar –zxvf CS_WebRTC_Conference_Server_Peer.v3.5.tgz</div><div class="line">cd PeerServer-Release-3.5</div><div class="line">npm install</div></pre></td></tr></table></figure>
</li>
<li><p>peer server配置证书</p>
</li>
<li>启动：node peerserver.js</li>
<li>停止：kill</li>
</ol>
<hr>
<h4 id="编译安装MCU-Server"><a href="#编译安装MCU-Server" class="headerlink" title="编译安装MCU Server"></a>编译安装MCU Server</h4><ol>
<li>安装nodejs npm ，安装n模块，切换node至合适版本</li>
<li>升级openssl-1.1.0g</li>
<li>编译安装libevent-2.0.21-stable</li>
<li>编译安装glibc-2.14 ，解决libc.so.6: version `GLIBC_2.14’ not found问题，参见<a href="http://blog.csdn.net/cpplang/article/details/8462768/" target="_blank" rel="external">http://blog.csdn.net/cpplang/article/details/8462768/</a></li>
<li>启动mongodb ：service mongod start</li>
<li>安装intel mcu sdk 【配置选择：软编码，非集群】<br>6.1 安装 Cisco OpenH264* Library<br>6.2 编译安装 ffmpeg with libfdk_aac<br>6.3 非GPU加速安装：<br><code>cd /root/intel-webrtc/MCUServer-Release-v3.5 
bin/init-all.sh</code><br>6.4 启动和停止：<br>//启动<br>cd /root/intel-webrtc/MCUServer-Release-v3.5<br>bin/start-all.sh<br>//停止<br>bin/stop-all.sh</li>
</ol>
<p>6.5 验证安装：打开 <a href="http://x.x.x.x:3004" target="_blank" rel="external">http://x.x.x.x:3004</a><br>6.6 修改配置文件，配置公网访问</p>
<ol>
<li>MCU管理控制台 MCU Management Console 操作说明<br>7.1 访问验证 <a href="http://x.x.x.x:3000/console/" target="_blank" rel="external">http://x.x.x.x:3000/console/</a></li>
<li>MCU Sample Server 安装运行<br>8.1 切换到目录/root/intel-webrtc/MCUServer-Release-v3.5/extras/basic_example<br>8.2 安装配置：按照 README.md 说明进行配置 node basicServer.js<br>8.3 访问验证： <a href="http://x.x.x.x:3001" target="_blank" rel="external">http://x.x.x.x:3001</a>  <a href="https://x.x.x.x:3004" target="_blank" rel="external">https://x.x.x.x:3004</a> </li>
<li>Simple RTMP Server安装运行<br>项目地址：<a href="https://github.com/ossrs/srs" target="_blank" rel="external">https://github.com/ossrs/srs</a><br>启动 ./etc/init.d/srs start<br>停止 ./etc/init.d/srs stop<br>重启 ./etc/init.d/srs restart</li>
</ol>
<p>问题1 ： MCU 占用过大磁盘空间，audio_agent  video_agent  webrtc_agent recording_agent sip_agent 等目录产生很多core 文件，参见 <a href="https://www.cnblogs.com/dongzhiquan/archive/2012/01/20/2328355.html" target="_blank" rel="external">https://www.cnblogs.com/dongzhiquan/archive/2012/01/20/2328355.html</a><br>查看命令： du -ah –max-depth=1    a表示显示目录下所有的文件和文件夹（不含子目录），h表示以人类能看懂的方式，max-depth表示目录的深度。<br>原因：在一个程序崩溃时，它一般会在指定目录下生成一个core文件。core文件仅仅是一个内存映象(同时加上调试信息)<br>解决方法：关闭core文件的生成 ulimit -c 0</p>
<p>问题2：node basicServer.js 3001端口占用<br>查看端口占用进程： netstat -anp|grep 3001<br>查看进程信息： ps -aux | grep 4994<br>结束进程 kill pid 4994</p>
<hr>
<h4 id="Android-Sample配置说明"><a href="#Android-Sample配置说明" class="headerlink" title="Android Sample配置说明"></a>Android Sample配置说明</h4><ol>
<li>更新 sample 依赖：<br>1.1 替换 以下位置jar包和so为CS_WebRTC_Client_SDK_Android.v3.5\libs 目录下同名文件。<br>sample\conferenceSample\libs<br>sample\conferenceSample\libs\src\main\jniLibs<br>sample\p2pSample\libs<br>samples\src\sample\p2pSample\src\main\jniLibs<br>sample\utils\libs<br>samples\src\sample\utils\src\main\jniLibs</li>
<li>配置 ICE 服务器：修改SampleActivity下 stunAddr 、turnAddrUDP、turnAddrTCP等变量为可用的 ICE server配置。</li>
<li>修改signaling server：在Setting 界面填入合适的信令服务器地址，如上如配置正确的Peer Server。</li>
</ol>
<hr>
<h4 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h4><ol>
<li>p2p 视频通话<br><img src="http://img.blog.csdn.net/20171121175636549?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveXVqaWh1OTg5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></li>
<li>p2p 屏幕分享<br><img src="http://img.blog.csdn.net/20171121175701850?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQveXVqaWh1OTg5/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="这里写图片描述"></li>
</ol>
<p>参考资料：<br>Intel SDK首页: <a href="https://software.intel.com/en-us/webrtc-sdk" target="_blank" rel="external">https://software.intel.com/en-us/webrtc-sdk</a><br>Server安装指南：<a href="https://software.intel.com/en-us/documentation/webrtc-conference-server-guide" target="_blank" rel="external">https://software.intel.com/en-us/documentation/webrtc-conference-server-guide</a></p>
</div><div class="tags"></div><div class="post-nav"><a href="/2017/11/27/Docker部署WebRTC Server AppRTC实现手机、浏览器互通简易指南/" class="pre">Docker部署WebRTC Server AppRTC实现手机、浏览器互通简易指南</a><a href="/2017/10/12/Android开源SIP协议栈比较/" class="next">Android开源SIP协议栈比较</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://wildcreek.github.io"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/11/27/Docker部署WebRTC Server AppRTC实现手机、浏览器互通简易指南/">Docker部署WebRTC Server AppRTC实现手机、浏览器互通简易指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/21/Intel WebRTC Collaboration Suite 服务端部署及客户端配置说明/">Intel WebRTC Collaboration Suite 服务端部署及客户端配置说明</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/12/Android开源SIP协议栈比较/">Android开源SIP协议栈比较</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/09/PJSIP2.7 Android版本编译及构建pjsua2和pjsua/">PJSIP2.7 Android版本编译及构建pjsua2和pjsua</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/09/Ubuntu14.0.4安装配置Kamailio5.0/">Ubuntu14.0.4安装配置Kamailio5.0</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/09/Kamailio glossary & misc(持续更新)/">Kamailio glossary & misc(持续更新)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/28/SIP proxy and SIP gateway/">SIP proxy and SIP gateway</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/18/Android Studio配置Gradle（包括signingConfigs、buildTypes和productFlavors等）/">Android Studio配置Gradle（包括signingConfigs、buildTypes和productFlavors等）</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/Android实现基于试卷知识点的树形控件/">Android实现基于试卷知识点的树形控件</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/Android实现选择题答题（包括单选、多选和答题卡）/">Android实现选择题答题（包括单选、多选和答题卡）</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2017 <a href="/." rel="nofollow">wildcreek.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.1.20/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>